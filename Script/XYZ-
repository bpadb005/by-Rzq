local player = game.Players.LocalPlayer
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local gui = Instance.new("ScreenGui")
gui.Parent = player:WaitForChild("PlayerGui")
gui.ResetOnSpawn = false

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 280, 0, 340)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.ClipsDescendants = true
frame.Parent = gui
Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 12)

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 35)
title.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
title.TextColor3 = Color3.fromRGB(230, 230, 230)
title.Font = Enum.Font.GothamBold
title.TextSize = 16
title.BorderSizePixel = 0
title.Text = "XYZ\nby Rzq"
title.Parent = frame
Instance.new("UICorner", title).CornerRadius = UDim.new(0, 12)

local function createHeaderButton(text, pos, color)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0, 22, 0, 22)
	btn.Position = pos
	btn.BackgroundColor3 = color
	btn.TextColor3 = Color3.fromRGB(230, 230, 230)
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 18
	btn.BorderSizePixel = 0
	btn.AutoButtonColor = false
	btn.Text = text
	btn.Parent = frame
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)
	return btn
end

local minimizeBtn = createHeaderButton("-", UDim2.new(0, 8, 0, 7), Color3.fromRGB(60, 60, 60))
local closeBtn = createHeaderButton("×", UDim2.new(1, -30, 0, 7), Color3.fromRGB(90, 40, 40))

local function hoverEffect(btn, normal, hover)
	btn.MouseEnter:Connect(function() btn.BackgroundColor3 = hover end)
	btn.MouseLeave:Connect(function() btn.BackgroundColor3 = normal end)
end

hoverEffect(minimizeBtn, Color3.fromRGB(60, 60, 60), Color3.fromRGB(80, 80, 80))
hoverEffect(closeBtn, Color3.fromRGB(90, 40, 40), Color3.fromRGB(120, 50, 50))

local contentMask = Instance.new("Frame")
contentMask.Size = UDim2.new(1, 0, 1, -40)
contentMask.Position = UDim2.new(0, 0, 0, 40)
contentMask.BackgroundTransparency = 1
contentMask.ClipsDescendants = true
contentMask.Parent = frame

local contentContainer = Instance.new("Frame")
contentContainer.Size = UDim2.new(1, 0, 1, 0)
contentContainer.BackgroundTransparency = 1
contentContainer.Parent = contentMask

local buttonContainer = Instance.new("Frame")
buttonContainer.Size = UDim2.new(1, 0, 0, 110)
buttonContainer.BackgroundTransparency = 1
buttonContainer.Parent = contentContainer

local buttonLayout = Instance.new("UIListLayout")
buttonLayout.Padding = UDim.new(0, 6)
buttonLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
buttonLayout.FillDirection = Enum.FillDirection.Vertical
buttonLayout.SortOrder = Enum.SortOrder.LayoutOrder
buttonLayout.VerticalAlignment = Enum.VerticalAlignment.Top
buttonLayout.Parent = buttonContainer

local xyzrtLabel = Instance.new("TextLabel")
xyzrtLabel.Size = UDim2.new(1, -20, 0, 24)
xyzrtLabel.Position = UDim2.new(0, 10, 0, 0)
xyzrtLabel.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
xyzrtLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
xyzrtLabel.Font = Enum.Font.Code
xyzrtLabel.TextSize = 14
xyzrtLabel.TextXAlignment = Enum.TextXAlignment.Center
xyzrtLabel.Text = "X:- | Y:- | Z:-"
xyzrtLabel.Parent = buttonContainer
Instance.new("UICorner", xyzrtLabel).CornerRadius = UDim.new(0, 6)

local function makeButton(text, color)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(1, -20, 0, 32)
	btn.BackgroundColor3 = color
	btn.Text = text
	btn.Font = Enum.Font.GothamSemibold
	btn.TextSize = 14
	btn.TextColor3 = Color3.fromRGB(255, 255, 255)
	btn.BorderSizePixel = 0
	btn.AutoButtonColor = false
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
	btn.MouseEnter:Connect(function() btn.BackgroundColor3 = color:Lerp(Color3.new(1, 1, 1), 0.1) end)
	btn.MouseLeave:Connect(function() btn.BackgroundColor3 = color end)
	return btn
end

local scrollFrame = Instance.new("ScrollingFrame")
scrollFrame.Size = UDim2.new(1, -10, 1, -160)
scrollFrame.Position = UDim2.new(0, 5, 0, 150)
scrollFrame.BackgroundTransparency = 1
scrollFrame.BorderSizePixel = 0
scrollFrame.ScrollBarThickness = 6
scrollFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
scrollFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
scrollFrame.ScrollingDirection = Enum.ScrollingDirection.Y
scrollFrame.ClipsDescendants = true
scrollFrame.HorizontalScrollBarInset = Enum.ScrollBarInset.None
scrollFrame.Parent = contentContainer
Instance.new("UIListLayout", scrollFrame).Padding = UDim.new(0, 4)

local savedXYZ = {}

local function updateList()
	for _, v in pairs(scrollFrame:GetChildren()) do
		if v:IsA("Frame") or v:IsA("TextLabel") then
			v:Destroy()
		end
	end

	local padding = Instance.new("UIPadding", scrollFrame)
	padding.PaddingLeft = UDim.new(0, 10)

	if #savedXYZ == 0 then
		local empty = Instance.new("TextLabel", scrollFrame)
		empty.Size = UDim2.new(1, -10, 0, 22)
		empty.BackgroundTransparency = 1
		empty.Text = "Belum ada XYZ tersimpan."
		empty.TextColor3 = Color3.fromRGB(150, 150, 150)
		empty.Font = Enum.Font.Gotham
		empty.TextSize = 13
		empty.TextXAlignment = Enum.TextXAlignment.Center
		return
	end

	for i, pos in ipairs(savedXYZ) do
		local entryFrame = Instance.new("Frame", scrollFrame)
		entryFrame.Size = UDim2.new(1, -10, 0, 24)
		entryFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
		entryFrame.BorderSizePixel = 0
		Instance.new("UICorner", entryFrame).CornerRadius = UDim.new(0, 6)

		local label = Instance.new("TextLabel", entryFrame)
		label.Size = UDim2.new(1, -60, 1, 0)
		label.BackgroundTransparency = 1
		label.TextColor3 = Color3.fromRGB(200, 200, 200)
		label.Font = Enum.Font.Code
		label.TextSize = 13
		label.TextXAlignment = Enum.TextXAlignment.Left
		label.Text = string.format("%d. (%.2f, %.2f, %.2f)", i, pos.X, pos.Y, pos.Z)
		Instance.new("UIPadding", label).PaddingLeft = UDim.new(0, 8)

		local tpBtn = Instance.new("TextButton", entryFrame)
		tpBtn.Size = UDim2.new(0, 18, 0, 18)
		tpBtn.Position = UDim2.new(1, -46, 0, 3)
		tpBtn.BackgroundColor3 = Color3.fromRGB(70, 160, 240)
		tpBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
		tpBtn.Font = Enum.Font.GothamBold
		tpBtn.TextSize = 14
		tpBtn.Text = "￫"
		tpBtn.BorderSizePixel = 0
		Instance.new("UICorner", tpBtn).CornerRadius = UDim.new(0, 6)
		tpBtn.MouseButton1Click:Connect(function()
			local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
			if hrp then hrp.CFrame = CFrame.new(pos) end
		end)

		local delBtn = Instance.new("TextButton", entryFrame)
		delBtn.Size = UDim2.new(0, 18, 0, 18)
		delBtn.Position = UDim2.new(1, -24, 0, 3)
		delBtn.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
		delBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
		delBtn.Font = Enum.Font.GothamBold
		delBtn.TextSize = 16
		delBtn.Text = "×"
		delBtn.BorderSizePixel = 0
		Instance.new("UICorner", delBtn).CornerRadius = UDim.new(0, 6)
		delBtn.MouseButton1Click:Connect(function()
			table.remove(savedXYZ, i)
			updateList()
		end)
	end
end

local saveBtn = makeButton("Simpan", Color3.fromRGB(50, 170, 90))
saveBtn.Parent = buttonContainer
saveBtn.MouseButton1Click:Connect(function()
	local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
	if hrp then
		table.insert(savedXYZ, hrp.Position)
		updateList()
	end
end)

local clearBtn = makeButton("Hapus Semua", Color3.fromRGB(200, 50, 50))
clearBtn.Parent = buttonContainer
clearBtn.MouseButton1Click:Connect(function()
	savedXYZ = {}
	updateList()
end)

local copyBtn = makeButton("Salin Semua", Color3.fromRGB(60, 120, 220))
copyBtn.Parent = buttonContainer
copyBtn.MouseButton1Click:Connect(function()
	if #savedXYZ == 0 then
		setclipboard("Tidak ada XYZ tersimpan.")
		return
	end
	local lines = {}
	for i, pos in ipairs(savedXYZ) do
		table.insert(lines, string.format("[%d] (%.2f, %.2f, %.2f)", i, pos.X, pos.Y, pos.Z))
	end
	setclipboard(table.concat(lines, "\n"))
end)

updateList()

local lastScrollPos = 0
local minimized = false

minimizeBtn.MouseButton1Click:Connect(function()
	minimized = not minimized
	if minimized then lastScrollPos = scrollFrame.CanvasPosition.Y end
	local frameTargetSize = minimized and UDim2.new(0, 280, 0, 40) or UDim2.new(0, 280, 0, 340)
	local maskTargetSize = minimized and UDim2.new(1, 0, 0, 0) or UDim2.new(1, 0, 1, -40)
	TweenService:Create(frame, TweenInfo.new(0.35, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), { Size = frameTargetSize }):Play()
	TweenService:Create(contentMask, TweenInfo.new(0.35, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), { Size = maskTargetSize }):Play()
	if not minimized then
		TweenService:Create(scrollFrame, TweenInfo.new(0.35, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), { CanvasPosition = Vector2.new(0, lastScrollPos) }):Play()
	end
end)

closeBtn.MouseButton1Click:Connect(function()
	frame:Destroy()
end)

RunService.RenderStepped:Connect(function()
	local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
	if hrp then
		local pos = hrp.Position
		xyzrtLabel.Text = string.format("X:%.2f | Y:%.2f | Z:%.2f", pos.X, pos.Y, pos.Z)
	else
		xyzrtLabel.Text = "X:- | Y:- | Z:-"
	end
end)
